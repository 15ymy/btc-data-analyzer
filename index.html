<!DOCTYPE html>
<html>
<head>
  <title>数据提取和计算</title>
</head>
<body>
  <h1>请将数据粘贴到下面的文本框中:</h1>
  <textarea id="data-input" rows="10" cols="50"></textarea>
  <br>
  <button onclick="calculateSum()">计算结果</button>
  <br>
  <h2>结果:</h2>
  <p id="result"></p>

  <script>
    function calculateSum() {
      const data = document.getElementById('data-input').value;
      const sections = data.split('\n\n');
      const values = {};

      for (let section of sections) {
        const lines = section.split('\n');
        const periodData = {};

        for (let i = 2; i < lines.length; i++) {
          const parts = lines[i].split(':');
          const period = parts[0].trim();
          const match = parts[1].match(/(-?\d+(\.\d+)?)(m|b|k)/i);

          if (match) {
            let value = parseFloat(match[1]);
            const unit = match[3].toLowerCase();

            if (unit === 'b') {
              value *= 1000;
            } else if (unit === 'k') {
              value /= 1000;
            }

            if (!periodData[period]) {
              periodData[period] = 0;
            }
            periodData[period] += value;
          }
        }

        for (let period in periodData) {
          if (!values[period]) {
            values[period] = 0;
          }
          values[period] += periodData[period];
        }
      }

      let sum = 0;
      for (let period in values) {
        sum += values[period];
      }

      document.getElementById('result').innerText = `总和为: ${sum.toFixed(2)} 百万美元`;
    }
  </script>
</body>
</html>
